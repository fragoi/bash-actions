#!/bin/bash -e
set -o pipefail

upstream_version=$1

if [ ! "$upstream_version" ]; then
  echo 1>&2 "Usage: $0 <upstream-version>"
  exit 1
fi

version="${upstream_version}-1"

tag=$(versionTagName "$version")

if [ "$(getRefId $tag)" ]; then
  echo 1>&2 "version ${version} already exists"
  exit 0
fi

echo "Upstream version ${upstream_version}" \
  | debChangelogEntryAdd "$version"

setGitIdentity

createTag "$version"
